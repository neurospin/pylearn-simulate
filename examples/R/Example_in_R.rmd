---
output: html_document
---
Simulated Data for Linear Regression with Structured and Sparse Penalties: Introducing  pylearn-simulate
========================================================================================================

Tommy Löfstedt & Vincent Guillemot & Vincent Frouin & Edouard Duchesnay & Fouad Hadj-Selem
------------------------------------------------------------------------------------------


The current example aims at illustrating the process of generating a simulated data set from a real data set. The advantage is that it inherits a realistic correlation structure from the real data set, which is crucial in e.g. Bioinformatics. 

### Ridge Regression With an Additional Group LASSO penalty

\[f(\beta) = \frac{1}{2}\|X \beta - y\|_2^2 + \frac{1}{2}\|\beta\|_2^2 + \sum_{g \in G} \| \beta_g \|_2 \]
For the sake of simplicity, the value of the penalisation parameters are fixed to 1. In order to be able to modify the data set, we need to define the following functions. Respectively, 



### The Original Biological Data Set

The real data set we used for this example is extracted from a microarray study dealing with the comparison of black matter gene expression profiles between patients with Parkinson's disease and controls [1]. The idea is that we have 3 different groups of genes:

* COG, a group containing genes involved in cognitive impairment,
* MOT, containing genes with an impact on motor symptoms,
* HLA, a control group with no link to Parkinson's disease.

When confronted to real data, it is difficult to know if the biological hypotheses formulated about the prior information can really be observed. In our example, it seems logical to formulate the hypothesis that genes linked to cognitive impairment and motor symptoms must be correlated to the fact that an individual has Parkinson's disease. Additionally, it is straightforward to assume that genes involved in the immune system have little impact on the phenotype. However, the reality of biological data is sometimes disappointing, as we see in the Heat Map below, it does not seem obvious that the 3 families of genes behave as expected. 

```{r data, echo=FALSE, cache=TRUE}
class <- structure(c(3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c("COG", "HLA", "MOT"
), class = "factor")

X_0 <- structure(c(6.64745633963616, 6.97793034963004, 6.87180753466337, 
6.63375757103202, 6.4794736876192, 6.74925647658771, 6.83048671175267, 
6.68680247813317, 6.87231834159316, 6.8212017614185, 6.7732421839829, 
6.54027668425517, 6.95569247639286, 6.67046436192472, 6.62300350242012, 
6.53826034414258, 6.49770321205895, 6.64553685758576, 6.56720992294061, 
6.70699496437957, 6.50794838009852, 6.63326321424075, 6.57605323269846, 
6.56123277837617, 6.63246232617263, 6.56802222202748, 6.56802664919108, 
6.56803719669454, 6.56804212986373, 6.56803153569941, 6.56800242819795, 
6.56803180042822, 6.56802849180891, 6.56804228389704, 6.5680263029456, 
6.56804125778148, 6.56805589196975, 6.56802669718518, 6.56802611146027, 
6.56803846110979, 6.56803167725606, 6.56802056528974, 6.56803166426316, 
6.56803535301139, 6.56802934729887, 6.56804641942841, 6.5680238235376, 
6.56803502805746, 6.56803718363225, 6.56803209724661, 6.27126877998121, 
6.27126923740489, 6.27129004570692, 6.27127058264734, 6.27127145037662, 
6.27127908342221, 6.2712874087086, 6.27127079995515, 6.27127613937442, 
6.27126856365202, 6.27128568906142, 6.27127491413439, 6.27128167341406, 
6.27127040896141, 6.27127224980492, 6.27126936320966, 6.27130470742899, 
6.27128221043087, 6.27125284044353, 6.27126445387196, 6.27127373545674, 
6.27128706167654, 6.27128052624248, 6.27127313893846, 6.27128141509332, 
8.05457338011119, 7.99538393362097, 7.61758722161825, 7.64557384541836, 
7.77998007402713, 8.00533392277051, 7.47123495041998, 7.7274170142352, 
7.6473167287381, 7.97641144764662, 7.65986175523675, 7.82751776830734, 
7.68095679903529, 7.89607193858831, 7.6642846003483, 7.90890946926213, 
7.99780987799556, 7.76053218094968, 7.99310109806646, 7.91222490105786, 
7.81869392387908, 8.13187310030384, 7.81861793252685, 8.14201053302063, 
7.80047407936763, 6.98241523631653, 6.98195743632663, 6.97768543381581, 
6.98107322046262, 6.9792362540854, 6.98230263906388, 6.97753501315262, 
6.97755032914755, 6.97850319520585, 6.97965576336854, 6.97770116151911, 
6.97968086383351, 6.98099298040009, 6.97980949427683, 6.97848016867383, 
6.98106510046029, 6.98091326571205, 6.98060559787853, 6.97927520439552, 
6.98041835351467, 6.97943945182122, 6.98200468668423, 6.97943742728414, 
6.98046733925612, 6.98049037966554, 8.43997299338587, 8.2493959245808, 
8.03192413713547, 7.91143703028391, 8.12101044687988, 8.32011253602662, 
7.8697988292824, 8.31094668112269, 8.05839213908395, 8.29200971814747, 
7.93778726988693, 8.30562343506759, 7.95160686018603, 8.44174271446687, 
8.30235559371802, 8.68375439457562, 8.64917084393256, 8.68491230050884, 
8.34747478432749, 8.22728421493827, 8.0438312171722, 8.51519904646972, 
8.16518902088931, 8.47476103308371, 8.22650861508231, 7.46500784223135, 
7.46498956162788, 7.46499679452779, 7.46502003153113, 7.46498685479032, 
7.46499453368624, 7.46499921860173, 7.46499279012278, 7.46499019492176, 
7.4649963105532, 7.46497903548922, 7.46499754569533, 7.46498126117694, 
7.46499003507196, 7.46500718807293, 7.46499513238212, 7.46498677022269, 
7.46498863208314, 7.46498545540242, 7.4649919316938, 7.4650195204732, 
7.46499929809613, 7.464987270763, 7.46498997589728, 7.46499999652137, 
7.71177524925709, 7.71175779390018, 7.71176369394426, 7.71177015608824, 
7.71177601532404, 7.71176168724283, 7.71177543685308, 7.7117574295275, 
7.71175937070616, 7.71177279125573, 7.71175690230926, 7.71177795258959, 
7.71179022788048, 7.7117644787368, 7.71177157442595, 7.71175054035538, 
7.71178338084187, 7.71177083759832, 7.71178075932217, 7.71178767252255, 
7.71176905511382, 7.71177899760492, 7.71177624454105, 7.71176382152427, 
7.71176302711423, 6.21722078658521, 6.21724750809953, 6.21723955768333, 
6.2172266039392, 6.2172218323731, 6.21722746890007, 6.21722927472776, 
6.21722243590341, 6.21722939034343, 6.21722595086628, 6.21721949847918, 
6.21723158379849, 6.21721944895355, 6.21725216224462, 6.21724318849314, 
6.21722913037679, 6.21724061682277, 6.21725174821069, 6.21722135625632, 
6.21722012349485, 6.21723568046764, 6.21722637981707, 6.21723677494427, 
6.21723084793488, 6.21721855580113, 6.20005446892543, 6.20005726810263, 
6.20005571341172, 6.20006805904082, 6.20004770006152, 6.20006602719073, 
6.20005730681567, 6.20007024355062, 6.20005494153433, 6.20007422234901, 
6.20005376905157, 6.20007625177122, 6.20005124629436, 6.20006958277007, 
6.20006757415877, 6.20007378455886, 6.2000639273209, 6.2000734755523, 
6.20005470847583, 6.20006193594463, 6.20009269753952, 6.20006865653018, 
6.20006282366689, 6.2000761745463, 6.20006897869388, 10.8513390037976, 
10.8411671746535, 10.9927906753394, 10.8485676696454, 10.7253031485252, 
10.5668986532403, 11.0892712103078, 10.9018700387014, 11.0574692975648, 
10.8652702161967, 11.1051898915726, 10.8200663504929, 10.9993509066596, 
10.9995381505254, 10.866815337425, 10.863857255803, 10.9560064666902, 
10.9534504008098, 10.6643118622874, 10.8010424923933, 10.8153419494075, 
10.9436657515102, 10.7108676384308, 10.8090397331823, 10.9001885068851, 
6.5410283915303, 6.54100507042626, 6.54101205135927, 6.54102343218483, 
6.54102564139315, 6.54102571893182, 6.5410108740531, 6.54098839210908, 
6.54101593376074, 6.54102446953871, 6.54102191517221, 6.54102401376474, 
6.54101411921738, 6.54103444830803, 6.54101131833899, 6.54102142222953, 
6.54101427258356, 6.5410268982839, 6.5410301610144, 6.54101222767701, 
6.54101425734054, 6.54102471301576, 6.54102170319809, 6.54101151822152, 
6.54103586468606, 9.07726196440019, 9.16657937519238, 9.34072567238722, 
9.02488535480083, 9.1823508179037, 8.88079946755433, 9.58906031124121, 
9.18906040921922, 9.53155765149707, 8.93912114563241, 9.18669300909781, 
8.93158929578347, 9.32165528840589, 9.14943436768927, 9.07314350652505, 
8.83843262046071, 8.95163288556741, 8.87902919838435, 8.62044026131095, 
8.98056966715193, 9.03613561846393, 9.09613394259454, 8.96710767827889, 
8.64519373076959, 8.90310472289785, 9.48219949601257, 9.48219058064861, 
9.48219323680789, 9.4822019902743, 9.48221508780166, 9.48221686633343, 
9.48219369065935, 9.48220281444646, 9.48219829988256, 9.48220001343737, 
9.48219351278578, 9.48220609316342, 9.48220542147663, 9.48219712452371, 
9.48219786055217, 9.48220884460147, 9.48221723818082, 9.48219919834949, 
9.48223264229686, 9.48220555018796, 9.48221080190657, 9.48219871556062, 
9.48219864936014, 9.4822057329489, 9.48218369520011, 7.14194832786066, 
7.00741847077322, 7.22508747623035, 6.85685094483174, 6.89423969493058, 
6.96616841451361, 7.202683282711, 6.98402232877258, 7.16175318499262, 
6.88719559102145, 6.9239222884782, 7.10780853072295, 6.99777917976902, 
7.09822215376806, 6.93856171310033, 7.14682294103879, 6.95203568199272, 
7.02650499061551, 6.81731355583537, 6.96046609175394, 6.91939147629239, 
6.98323100061177, 7.02889628182606, 6.96228984585886, 6.97819108785314, 
7.34566098165522, 6.70396947209192, 8.95721796028326, 8.6430545932439, 
7.10445953932569, 8.40492026338209, 6.69760243618167, 7.62966650081877, 
7.08383768378707, 8.75461700687047, 7.45951902383233, 9.83698647371138, 
9.14009241239691, 9.91560454033001, 6.86225192270602, 8.52120873924865, 
9.07463683928694, 6.52669765989543, 8.23218059060462, 7.42011915955158, 
8.54608667342579, 9.84961001983982, 9.79969776576208, 8.44667176989304, 
7.79447844247965, 8.77071787617653, 8.46146353251314, 8.62479604925404, 
8.2470174747854, 8.55853438707118, 8.38280403137985, 8.38979863535676, 
8.444348328407, 8.48704036466528, 8.75494469351306, 8.59045539436933, 
8.71666554133316, 8.48961965605233, 8.85222724662887, 8.69268522515105, 
8.61721860868601, 8.8796311783654, 8.69441596797723, 8.53356054248943, 
8.48210211961315, 8.64427051518399, 8.80573752988929, 8.57392991244552, 
8.59726999530744, 8.54299554866656, 9.28018010411526, 8.92496103948012, 
9.135656030675, 8.77257055514289, 9.29237390633582, 9.01466593353505, 
8.85483128048674, 9.01825258328778, 9.02007718171683, 9.26242179576407, 
9.12480623999759, 9.28155478743673, 8.95445575491922, 9.59433288328511, 
9.28242710142853, 9.26931268522073, 9.4596529523888, 9.31723012342498, 
9.0465699627398, 9.02647402049425, 9.14292440488357, 9.38429444711757, 
9.24436380971087, 9.16269977362921, 9.06275508724381, 7.56072085263388, 
7.56073214593016, 7.56070813176254, 7.56071778358632, 7.56070142596886, 
7.56071188005056, 7.56072298214083, 7.56073946946571, 7.56071583090111, 
7.56071854524757, 7.56069845228431, 7.56071574279536, 7.56071286873178, 
7.56070701057873, 7.56071010343838, 7.56072512415299, 7.56070902752453, 
7.56070921176542, 7.56070926197995, 7.56070400355252, 7.56072094087595, 
7.56072204509037, 7.56069721450356, 7.56071650142551, 7.56072730547507, 
7.11436875530065, 7.11436307533703, 7.11436750688881, 7.11437097160483, 
7.1143767633776, 7.11437398809922, 7.11436503731999, 7.11437780085443, 
7.11435296184731, 7.11435330657091, 7.11434974430868, 7.11435799011353, 
7.11436663123829, 7.11435744011608, 7.11437645954179, 7.11436574522945, 
7.11437980450748, 7.11436790323848, 7.11436811264564, 7.11438124164129, 
7.11437020403947, 7.11435203780417, 7.11437981364419, 7.11435057294189, 
7.11438175558878, 11.0880781475635, 10.3656939633527, 10.7398463907024, 
10.6679784511163, 10.5693154464468, 10.4291227821533, 10.554050022893, 
10.3393644434078, 11.1969524341207, 10.6561959994959, 10.4472059639417, 
10.7656019142533, 9.30517042286545, 9.97339109085791, 11.3342749610489, 
10.5469562081581, 10.7180328119319, 10.4191305289435, 9.92577960397995, 
10.4387039103602, 11.035422755165, 10.5963912627192, 9.67989569932856, 
9.88642672597301, 10.4963024057304, 10.6079008441776, 10.2849680442495, 
10.5482074664158, 10.4569356054088, 10.5296488679959, 10.4870637719692, 
10.4434180321992, 10.4379700091758, 10.7841186609671, 10.2759601683222, 
10.2903474863905, 10.4412501198716, 9.49791964726005, 10.507350845755, 
10.784839192608, 10.4708362853337, 10.5798717596565, 10.6575350980238, 
10.3537350626406, 10.47669913414, 10.635399159165, 10.5027308597965, 
10.027546095983, 10.2160999567061, 10.3403663490188, 6.58737201645823, 
6.58738026480226, 6.58735682393015, 6.5873762838737, 6.58734977940279, 
6.58734822992297, 6.58737011786217, 6.58736153522476, 6.58736316199279, 
6.58735865545024, 6.58736936553388, 6.58736807895191, 6.58738235624149, 
6.5873610106015, 6.58737092138066, 6.5873788658349, 6.58734320398653, 
6.58737299183259, 6.58736472555911, 6.58737115179118, 6.58735863414119, 
6.5873510436516, 6.58736663161838, 6.58735996529345, 6.58736895807308, 
6.36879607760988, 6.36876867365867, 6.36877291814397, 6.36878977619168, 
6.36876808708321, 6.36876213032195, 6.36875717838629, 6.3687560754655, 
6.36876736473265, 6.36877777256476, 6.3687823655448, 6.36877470879765, 
6.3687667402847, 6.36875831796073, 6.36876219679081, 6.3687624678608, 
6.36876933659498, 6.36875641784891, 6.36877408595246, 6.36875464978461, 
6.36877133193266, 6.36876545806775, 6.36876158157242, 6.36876713012277, 
6.36876588398376, 9.63430066235961, 9.44267061684853, 9.63840901452659, 
9.53708608793728, 9.64150789395275, 9.60280478262139, 9.55761077875659, 
9.5521634313704, 9.80927499391272, 9.46269965809035, 9.50821399647589, 
9.59760467682911, 9.02149746389945, 9.63414080926598, 9.87023646703372, 
9.63358398373585, 9.66649809837275, 9.67754214344757, 9.54039327229841, 
9.53284587245022, 9.68262302283826, 9.64523797261124, 9.32540611535322, 
9.38051514318943, 9.55351496628027, 9.66602276248583, 9.75334909873101, 
9.69927195418493, 9.58324257717444, 9.75016773194594, 9.64024228307613, 
9.33486439433807, 9.6408203639478, 9.56905460311754, 9.73039230422272, 
9.2938008574828, 9.5893498701975, 9.57610450040677, 9.65831740323364, 
9.80625670470169, 9.77215096779169, 9.84219360808134, 9.81346272270245, 
9.95495025754623, 9.57274012823707, 9.64765127265076, 9.7096992692414, 
9.61103377263162, 10.0721929837962, 9.96724206198447, 9.69157481393772, 
9.78880759067575, 9.75596798386493, 9.66033660181862, 9.88953766056009, 
9.71668437969573, 9.42952337911878, 9.72310489706331, 9.55039416881419, 
9.79570703044704, 9.33723325654854, 9.63895810766382, 9.57768419494739, 
9.69086099702179, 9.84197639055453, 9.78340386862605, 9.91451032222756, 
9.86123121781927, 10.0892120641261, 9.65869426303824, 9.69087939966829, 
9.76764737542945, 9.665844836911, 10.1387126344485, 9.98416066929543, 
9.28958045706651, 9.47703483170619, 9.41006020983199, 9.11255706487315, 
9.34728462046652, 9.21862766273642, 8.99208125980543, 9.20829491201089, 
9.20258265386072, 9.53868631470815, 9.00363753912192, 9.28613567535531, 
9.24754523066926, 9.12982160886572, 9.49244268397232, 9.39754608466522, 
9.52610541736765, 9.35523817959835, 9.45473660331837, 9.20809563260536, 
9.28460371605577, 9.32548564714173, 9.01723042716485, 9.59434256522757, 
9.55739713148921, 9.70170314797545, 9.85711905337892, 9.75997222269065, 
9.65466054098771, 9.9221682011095, 9.74281091461872, 9.36952201376687, 
9.71342696990104, 9.59676467191297, 9.86724770981168, 9.27341772200724, 
9.65589559121676, 9.64110969528585, 9.66373505478559, 9.93643288288025, 
9.8762934535401, 10.0437302596522, 9.89565591158949, 10.1546479886044, 
9.67125229283516, 9.7325516711692, 9.80464694672208, 9.68727924586648, 
10.2632925709963, 10.0769189581178, 9.19928228859738, 9.19926308362307, 
9.19926173286597, 9.19928963868757, 9.19930255010349, 9.19927555527953, 
9.19928013518816, 9.19928755101134, 9.19927307999432, 9.19926737745945, 
9.19927879133092, 9.19927825286252, 9.19927829895538, 9.19928307145985, 
9.19926437423793, 9.19928275025859, 9.19927133482268, 9.19928043517286, 
9.19927571171269, 9.1992929972595, 9.19927894972195, 9.19928612761382, 
9.19927290515018, 9.19928900492846, 9.19929703511799, 7.98058441029379, 
7.23124434039561, 7.03016185993896, 6.97690374312602, 7.35815163079581, 
7.42447054969959, 7.37337313426819, 7.4501591633437, 7.65543782811207, 
7.40825191758262, 6.92896301032149, 7.0853426588239, 6.98052601337279, 
6.8402568766223, 7.51385094040002, 7.20536537147593, 7.61082007672684, 
8.66572139589437, 7.37356895167985, 7.33352939321042, 7.32051663025521, 
6.81690404913623, 6.95689089703296, 7.05865028556462, 8.08050441809927, 
12.7097638843101, 11.9322764450213, 12.4136948107194, 12.2854217232734, 
12.3491873085084, 12.1483388863803, 12.0636943965916, 11.9365092195217, 
12.1975374871678, 12.3952966968294, 12.4453634122428, 12.3763945505571, 
11.9087978153723, 12.151627632988, 12.6839360870449, 12.1478846164342, 
12.4021137132199, 12.6130159165281, 11.7450895460872, 12.4828661491011, 
12.6262191178039, 12.5381512470271, 11.729566740567, 11.987808347638, 
12.2885047652178, 12.7967409174336, 12.2248484170262, 12.6158848855945, 
12.363404586298, 12.5562673487164, 12.3363527301181, 12.245126684041, 
12.1825673177644, 12.4290232303522, 12.4891251817566, 12.6167668061345, 
12.5528801139727, 12.0709483935322, 12.430270322635, 12.956298464358, 
12.3682782095973, 12.6120549206533, 12.9099005056535, 11.9514186655119, 
12.69307255839, 12.8075647276235, 12.6427826190218, 11.8837567389421, 
12.2801176474327, 12.5222800014862, 9.33136502869702, 8.56910811835888, 
9.0098756062614, 8.76208262471576, 8.98824946134361, 8.71164390668196, 
8.67597272320683, 8.71141210219918, 8.82300865437838, 8.85308330776081, 
8.70856439634792, 8.91318721008028, 8.58408842636963, 8.7493345868051, 
9.21403217246091, 8.93357782339184, 9.15737591635179, 9.21361731436399, 
8.65218198088235, 8.83979360589579, 9.09991617595977, 8.95037140188976, 
8.64170289062267, 8.70529487495693, 8.71949977208102, 7.63501973214539, 
7.6350159126804, 7.63501691476415, 7.63501854495364, 7.63505884511086, 
7.63502963153732, 7.63501927147005, 7.63503587633154, 7.63503154566598, 
7.6350160495066, 7.63504182286627, 7.63502386363082, 7.63503017105869, 
7.63502780528605, 7.63502660498121, 7.6350297921674, 7.6350233210506, 
7.63503347589915, 7.63504211807259, 7.63501654312978, 7.63502921484515, 
7.63502461587214, 7.63504052074868, 7.63503485918632, 7.63503292272536, 
9.97476931804192, 9.97644551923054, 9.96613128161567, 9.95921132424733, 
9.88836487730574, 9.93204818675521, 9.92460778241941, 9.94041074255186, 
9.93081108583534, 9.96218408717601, 9.89024032792535, 9.98028104138459, 
9.92715748659211, 9.94455798152371, 9.94421704247585, 9.95090835951769, 
9.957605952185, 9.95173958836335, 9.92974125044934, 9.95785578410173, 
9.94748100255779, 9.94619496585731, 9.92142095591094, 9.94788281531821, 
9.9550895433724, 8.22816321062071, 8.28322798695963, 8.46457818187602, 
8.17502761061697, 7.9472380771485, 8.01282523286854, 7.98010687853664, 
8.05394983211082, 8.08004075161109, 8.25945381158619, 7.85639718068456, 
8.29176766455185, 8.00193251651085, 8.14362160523513, 8.13154145042465, 
8.1697338037092, 8.16795072921884, 8.23484391035899, 7.98773319216998, 
8.19192328276108, 8.00047239425028, 8.07072375869735, 7.81502685198835, 
8.18493714742145, 8.19377179783524, 8.53300688039433, 8.64194784196999, 
8.41212775216663, 8.20047602977218, 7.62918924401233, 7.91950670934322, 
8.07336954116119, 7.74465809434606, 8.08055499557384, 8.51130167104825, 
7.79847900748385, 8.28303225412999, 8.02174663499369, 7.75399889930504, 
7.83312805552342, 7.72826905914649, 8.26378099704657, 7.28775623515168, 
7.57266925994559, 8.23002949632376, 8.28448776896941, 8.1845760322618, 
7.69480727634474, 7.50908604897072, 7.98737232344671, 7.66343091417999, 
7.66344552143218, 7.6634058620784, 7.66337485716734, 7.6633033434042, 
7.66334552168947, 7.66333249018337, 7.66329606030573, 7.66335585793492, 
7.66342754642766, 7.66326079767106, 7.66339092828277, 7.66334039160256, 
7.66329582019906, 7.66330998643729, 7.66333659275888, 7.66338464908036, 
7.66325865543536, 7.66325085408313, 7.66340272128721, 7.66336993440597, 
7.66335209390018, 7.66329773256615, 7.66326869031486, 7.66336224646906, 
9.26918674778994, 9.55856494492823, 10.5059451965109, 9.60497891277847, 
8.82271568008187, 9.40989516436083, 11.2199622176309, 9.63199991150383, 
10.7486011716698, 9.45059660544048, 9.71956395657003, 9.30248767128609, 
9.45281015337514, 10.0880808411549, 9.55435038379538, 9.28240072845772, 
9.53924111153716, 9.20063082372844, 8.83570387996496, 9.35369201479187, 
9.20244559903517, 9.61954729722589, 9.55133828036495, 9.00884798162652, 
9.36821809394808, 9.29645776311002, 9.15241981081882, 10.0979466028204, 
9.61976250586092, 8.76794620754273, 9.5374682414111, 10.621486674504, 
9.92462875917944, 10.5296677903388, 9.21377798679754, 9.35125584709095, 
8.85729562031281, 8.91975807675651, 9.60712570258188, 9.34376528085704, 
9.20660884990677, 9.26051467149009, 9.1089142337918, 9.13523365263279, 
9.18244446428368, 9.08503406124933, 9.33407625741643, 9.1966521035681, 
9.19740787208157, 9.29934777341231, 8.30930027252488, 8.45031221137996, 
8.88174161226573, 8.40859329112181, 8.13830924033248, 8.35435095254175, 
9.06490202389239, 8.43200856897092, 8.91041665909415, 8.49989629324623, 
8.52189502237894, 8.34950231508502, 8.43919658491347, 8.56046749557004, 
8.45712498405169, 8.34131496302332, 8.50334945744383, 8.23481374158797, 
8.17160499233534, 8.36350172995831, 8.33135165004931, 8.38890249194023, 
8.31045355967715, 8.15663094581536, 8.42510359305245, 8.11162055871475, 
8.28699585044767, 8.76700430388523, 8.27459982056454, 8.05345574974825, 
8.21159834881858, 9.0145537351762, 8.25188496607444, 8.8241472570055, 
8.28925594404826, 8.35852548197647, 8.25697768147834, 8.24985378638622, 
8.41141686178061, 8.25869558745099, 8.13498134001307, 8.29851424193106, 
8.08543403119804, 8.03054082403728, 8.16515545550012, 8.12433872112444, 
8.20511526907586, 8.25010488223307, 8.05516598856537, 8.20536009613641, 
8.05829274184705, 8.34600551259942, 9.23025105113435, 8.1364711945118, 
7.84802682199212, 8.24124788136969, 9.62800814089385, 8.73499873621651, 
9.4084468066324, 7.96222243820225, 8.25842740501918, 7.79829840308459, 
8.07105894395971, 8.59679390135546, 8.17144292470173, 8.13325300596707, 
8.10952896779118, 8.01156281578111, 7.92607172572959, 8.09108642428234, 
7.89537179422521, 8.31687962007145, 8.07924139630888, 8.22263975851344, 
8.31810405874664, 6.36876650316475, 6.36876437873466, 6.36875748649734, 
6.36878262485947, 6.36877088514724, 6.36876968700357, 6.3687734228122, 
6.36877718185801, 6.36877108393045, 6.36876447899955, 6.36876619133777, 
6.368782755661, 6.36877783617338, 6.36877331614629, 6.36875537510267, 
6.36876783875851, 6.36874195045748, 6.36875633153613, 6.3687756430497, 
6.36877979794157, 6.36876161364139, 6.36876897704417, 6.36877692459064, 
6.3687760988351, 6.36875034397535, 6.04786745598924, 6.04787545044772, 
6.04788718528897, 6.04789185136454, 6.04789107364215, 6.04788455255238, 
6.04788573955899, 6.04787781457659, 6.04787651825724, 6.04789447302748, 
6.04788168258385, 6.04787137386674, 6.04788258620046, 6.0478995961124, 
6.04789448630324, 6.04788207562785, 6.047897388883, 6.04787298970502, 
6.04788526403004, 6.04790296253487, 6.04789627375207, 6.04788808688168, 
6.0478957935195, 6.04790657968151, 6.04789398052622, 7.64828708970795, 
7.9267985350215, 7.90326744808758, 7.69509751023195, 7.51491060937017, 
7.66325039495602, 8.23623314640485, 7.73702957897463, 7.97277295574314, 
7.76340667494606, 8.01204321295683, 7.75336852719022, 8.16249056365725, 
8.05321984360866, 7.67523152510899, 7.626579854928, 7.72987987316838, 
7.57458347024629, 7.64481952824488, 7.80621507698923, 7.76612706945245, 
7.97397329390953, 7.77191651992467, 7.60201148170169, 7.79547622792684, 
7.84332527879325, 8.17459952799385, 8.15557560478244, 7.89364684796698, 
7.73986239939534, 7.90640513270018, 8.62201694541378, 8.21571680335503, 
8.45372306243864, 7.97625152531557, 8.38078647595287, 7.84084288083072, 
8.56526754569437, 8.51543296710564, 8.0075001540835, 7.81707841937442, 
7.88759817808583, 8.00526368498624, 7.9090689613157, 8.15552260197006, 
8.08729894645012, 8.1940549456329, 8.1166596320353, 8.05830090108617, 
7.96828722480027, 6.37435259979863, 6.37435625474517, 6.37434804175582, 
6.37432167911425, 6.37435322503443, 6.37432342530019, 6.37433939808835, 
6.37435061991779, 6.37435113909258, 6.37433825271537, 6.37436881839184, 
6.37434621411947, 6.37433306766327, 6.37434570850778, 6.37433594390351, 
6.37434618142203, 6.37435257216524, 6.37434775514703, 6.37435024289964, 
6.37433491528285, 6.37433819083798, 6.37434181686617, 6.37434163236049, 
6.37433785948841, 6.37434417134421, 6.64037129503762, 6.64040528004414, 
6.6403858343571, 6.6404164886609, 6.64038485307871, 6.64039726419495, 
6.64039480179756, 6.64039874577786, 6.64039316421929, 6.6403856361783, 
6.64039435555087, 6.64038937638821, 6.64039222767959, 6.64040049953628, 
6.64037882104167, 6.64037511975597, 6.64038651514988, 6.64038829481654, 
6.64039081721408, 6.64039287046176, 6.64037645537578, 6.64037970894926, 
6.64038083068135, 6.64038224915273, 6.64039749627325, 6.61527693248417, 
6.61528946437234, 6.61528969212348, 6.61529286707555, 6.61529525399953, 
6.61529839778486, 6.61529435717706, 6.6153045424059, 6.61530836409011, 
6.61529458258065, 6.61529628956085, 6.61530735596117, 6.61529192479295, 
6.61528765573869, 6.61529410855417, 6.61529653600386, 6.61530272488859, 
6.61528790159734, 6.61528991998292, 6.61531856833718, 6.61531899391865, 
6.61530194998114, 6.61530707619329, 6.61531427952076, 6.61530473817768, 
6.05656426755167, 6.05657999652027, 6.05656469681555, 6.05658740915983, 
6.05657526094297, 6.05658353876232, 6.05658197181708, 6.05658534885237, 
6.05659454107458, 6.05658089705364, 6.05658201519822, 6.05659375597643, 
6.05658178785666, 6.05657225702691, 6.05659440234681, 6.05656676055011, 
6.05659003893675, 6.05658436721614, 6.05657792449138, 6.05660892843863, 
6.0565822363594, 6.05659437148533, 6.05658539579149, 6.05659158814668, 
6.05658445078797, 6.21567688245498, 6.21567577057108, 6.21567793360521, 
6.21568488474908, 6.21567133251551, 6.21568996998531, 6.21569713624904, 
6.21568605969662, 6.21568044542744, 6.21567417291071, 6.21565812174202, 
6.21567136967755, 6.21567589425868, 6.21567701664391, 6.21568379510327, 
6.21567416495806, 6.21567048811078, 6.21568631305402, 6.2156861281349, 
6.21568196212306, 6.21569861537525, 6.21567887865632, 6.21568636231705, 
6.2156578668789, 6.21566334999946, 10.2820667072466, 9.31689580792955, 
9.90524442362149, 9.45371855525316, 9.5855962162111, 9.30331507309253, 
9.11865079955351, 9.0577271045549, 9.37046486614556, 9.32284326818653, 
9.42849547760895, 10.1693310303681, 9.02751616288396, 9.62942683562737, 
10.1858735117247, 9.59702072742343, 9.40674602352535, 9.44743301346994, 
8.99266133931767, 9.29242072129281, 9.37435134179417, 9.48492565090514, 
9.88258710130525, 9.05431343080498, 9.82247972978669, 11.1581707309736, 
10.0940570344477, 10.6809174372766, 10.2783580825922, 10.4159690662479, 
10.0639293916935, 9.72931223686234, 9.67481733556813, 10.0902571549947, 
9.90296294363451, 10.2635991867319, 10.9218412957714, 9.47267341297781, 
10.4779686675891, 10.9302993908093, 10.5101286425632, 10.1876479773658, 
10.5239336657622, 9.60831104827454, 10.0636742971017, 10.0288827047636, 
10.2348547480992, 10.8972947140865, 9.93783056019462, 10.5737778910451, 
10.5492517491748, 9.45434850087893, 10.1063079306177, 9.67484965336767, 
9.74623120763681, 9.54497818487272, 9.43735625562089, 9.24199745567534, 
9.45890778921588, 9.52762220562114, 9.73283626261142, 10.4267679781989, 
9.045396270017, 9.71530346614202, 10.3398938527071, 9.65042672489411, 
9.63329364757472, 9.71886045696824, 9.16149278370096, 9.39948335490709, 
9.67842333031036, 9.53221850498149, 9.94510616799938, 9.22300061584929, 
9.81023579274639, 11.0719117872353, 10.2015536242807, 10.6525702798923, 
10.4670135220288, 10.3967014452031, 10.292792394282, 9.96367051837922, 
9.86791657618744, 10.1213954330309, 9.92662410836017, 10.2827826363615, 
10.8952096344384, 9.58102633956709, 10.5477183065827, 10.8733677356977, 
10.4942470308016, 10.2052311840476, 10.6182584894279, 9.84797790694041, 
10.1945638800191, 10.190068345863, 10.3727571152653, 10.821921381829, 
10.0409363325182, 10.5489514678771, 8.56829660919705, 8.30677064173776, 
8.4767831031461, 8.3422890391068, 8.32532458948769, 8.33167796739219, 
8.29281020177034, 8.25369574046783, 8.31286649212208, 8.3454413511002, 
8.31791028510667, 8.52201548736919, 8.22741931626562, 8.38383465028277, 
8.6324644464864, 8.3503107154084, 8.31619336455096, 8.3719434226317, 
8.23938271548849, 8.30131217224138, 8.35278076960533, 8.3398484252389, 
8.45541055983758, 8.24579563650978, 8.40199335167018, 10.4580060144605, 
9.5848532412971, 10.0228016146424, 9.81996714475956, 9.82310920677822, 
9.64218036637662, 9.353099401172, 9.28924701894947, 9.48753465702276, 
9.35091136445174, 9.63585546481631, 10.2467344100204, 8.96402855288373, 
9.88384740005925, 10.1857418955777, 9.87908035781965, 9.63883169308014, 
9.97961662963366, 9.24866900342186, 9.55553158760486, 9.52582550421272, 
9.74596278451503, 10.2192693602561, 9.38291620358587, 9.85715178798662, 
10.4471218636739, 9.86380857934877, 10.0641318915313, 10.045326279542, 
9.96888147928639, 9.83592197295672, 9.51703784001113, 9.54934884276388, 
9.66982212917773, 9.60409962298831, 9.81925883412359, 10.3053975271615, 
9.19806033407002, 9.97951356380715, 10.1515388012429, 10.0717000980898, 
9.73443966381307, 10.1212625955088, 9.5351968774659, 9.83135324052899, 
9.72202862130744, 9.85551596955079, 10.2179723770791, 9.69834605803237, 
10.0629483553011, 10.7596992038747, 10.3764199766282, 10.6413101057566, 
10.201173438406, 10.430984528878, 10.3518194202541, 10.3072328562781, 
10.3527471034718, 10.4837648418267, 10.406775992035, 10.2842597928244, 
10.6780579016124, 10.263277480704, 10.6069948332162, 10.7349307878731, 
10.4534155624947, 10.2833292856895, 10.5073759525738, 10.2376078985891, 
10.4155954742991, 10.3108390704951, 10.5009110814387, 10.6286147377198, 
10.3122713783388, 10.6419383721089, 11.1742221893271, 10.4590163193817, 
10.9408826637089, 9.83768337423498, 10.503042104497, 10.2885824789912, 
10.160945384566, 10.0887605276161, 10.5916821206766, 10.4416776992113, 
10.2159711313239, 11.0166737628642, 10.2058594869258, 10.8567875808137, 
11.0653819752376, 10.5366479671459, 10.1602092972082, 10.4730478522447, 
10.0418867858313, 10.3127001458107, 10.1513495481399, 10.6095482559907, 
10.8028100014345, 10.1170059173636, 10.8913300470814, 6.96920630021261, 
6.84728241401111, 8.97230281897145, 8.03166826994202, 7.41283600748367, 
8.321646067297, 7.54401156402812, 6.86718575679506, 6.93788785892191, 
6.89647560139906, 7.80649906745513, 6.9148252846523, 6.98368265406796, 
6.8044992724078, 8.33314468101678, 6.88536821767289, 8.3602468008027, 
6.92791556327074, 7.35008183162035, 6.96714763852734, 7.85910140286934, 
7.92837143171346, 8.19952344153858, 8.25296645813786, 6.87995043451446, 
6.03297057668489, 6.03299019712892, 6.03298242426656, 6.03298509513244, 
6.03298740095087, 6.03298306138435, 6.0329737893023, 6.03298075352832, 
6.03297087655645, 6.03298553738294, 6.03299416419061, 6.03297092030855, 
6.03299556699041, 6.03296502766403, 6.03297810255391, 6.03298094271247, 
6.03298118010898, 6.03300043869169, 6.03299317344331, 6.03298383903837, 
6.03296951471744, 6.03299188562534, 6.03296794210797, 6.03297708688907, 
6.03300092012554, 6.46333564496307, 6.46337323448539, 6.46336868897538, 
6.46335435135416, 6.46335541768119, 6.46337086426116, 6.46334815459318, 
6.46336389935566, 6.46335453966924, 6.46336356725893, 6.46336319810916, 
6.46336893404061, 6.46335350058939, 6.46336372759179, 6.46336999100396, 
6.46336859958373, 6.4633350910659, 6.4633622410229, 6.46335711660075, 
6.46336671887833, 6.46336378445203, 6.4633668783862, 6.46336867012683, 
6.46337152277081, 6.46335380859671, 8.24828290455069, 8.24831213277502, 
8.24829645226549, 8.2483243627345, 8.24829759855869, 8.24832350953705, 
8.24831520787018, 8.24831568817052, 8.24830477140232, 8.24830457083215, 
8.2482990928088, 8.24829298503879, 8.24831906274381, 8.24830592944869, 
8.24829406466903, 8.24831306959128, 8.24831669264595, 8.24830843894402, 
8.24831342413427, 8.2483125230618, 8.24830141925254, 8.24831373471293, 
8.24830270852943, 8.24830988908264, 8.24829776882042, 9.64655642269952, 
9.02166972345842, 9.37284211667342, 9.06191797789121, 9.34978671284723, 
9.06669455538462, 8.87387445173811, 8.77331762419833, 9.05000100143575, 
9.09966584246031, 9.07432986112319, 9.53199379531403, 8.74558483470069, 
9.07165080596992, 9.50026790641825, 9.23286321765947, 8.99793906245406, 
9.09888604864406, 8.75602020720263, 8.98189080193105, 9.07720455609264, 
9.10449097158486, 9.30385428857445, 8.83656621210583, 9.14159736441322, 
9.22288519558024, 8.5042315416674, 8.98544490343444, 8.5366949918554, 
8.55510199943043, 8.39658103777791, 8.38637304999146, 8.2076670617785, 
8.55972966287398, 8.58504212404054, 8.45874826949576, 9.07022432663245, 
8.25837611340727, 8.80663125765144, 9.01789239199311, 8.69151486556985, 
8.52013498378999, 8.64063720462253, 8.26011044311328, 8.58559757171642, 
8.49454714518184, 8.66443548303839, 8.85697301344181, 8.38428866603835, 
8.79042741092853, 7.92288544347849, 7.92291949371346, 7.92291147252822, 
7.92291069683998, 7.92291542507758, 7.92292058061704, 7.92292282008486, 
7.92291796779424, 7.92291391907461, 7.92292001508957, 7.92291619048919, 
7.92289305156086, 7.9229275152326, 7.92290024843345, 7.92289318409968, 
7.92291289391351, 7.92292180381173, 7.92291042173811, 7.92290532277204, 
7.92290615352455, 7.92291523194327, 7.92291121107414, 7.92292056355281, 
7.92290927631353, 7.92290425369725), .Dim = c(25L, 69L), .Dimnames = list(
    c("GSM184354.CEL", "GSM184355.CEL", "GSM184356.CEL", "GSM184357.CEL", 
    "GSM184358.CEL", "GSM184359.CEL", "GSM184360.CEL", "GSM184361.CEL", 
    "GSM184362.CEL", "GSM184363.CEL", "GSM184364.CEL", "GSM184365.CEL", 
    "GSM184366.CEL", "GSM184367.CEL", "GSM184368.CEL", "GSM184369.CEL", 
    "GSM184370.CEL", "GSM184371.CEL", "GSM184372.CEL", "GSM184373.CEL", 
    "GSM184374.CEL", "GSM184375.CEL", "GSM184376.CEL", "GSM184377.CEL", 
    "GSM184378.CEL"), c("206382_s_at", "239367_at", "1560317_s_at", 
    "205425_at", "205426_s_at", "226364_at", "202389_s_at", "202390_s_at", 
    "1554855_at", "1555668_a_at", "200006_at", "207058_s_at", 
    "209018_s_at", "209019_s_at", "229584_at", "213479_at", "208817_at", 
    "208818_s_at", "213981_at", "216204_at", "203381_s_at", "203382_s_at", 
    "212874_at", "212883_at", "212884_x_at", "202931_x_at", "210201_x_at", 
    "210202_s_at", "214439_x_at", "214643_x_at", "1559228_at", 
    "208791_at", "208792_s_at", "222043_at", "203134_at", "212506_at", 
    "212511_at", "215236_s_at", "215832_x_at", "204466_s_at", 
    "204467_s_at", "207827_x_at", "211546_x_at", "236081_at", 
    "219954_s_at", "222943_at", "223921_s_at", "224627_at", "206244_at", 
    "208488_s_at", "217484_at", "217552_x_at", "244313_at", "208729_x_at", 
    "209140_x_at", "211911_x_at", "208812_x_at", "211799_x_at", 
    "214459_x_at", "216526_x_at", "213932_x_at", "215313_x_at", 
    "209728_at", "215666_at", "215669_at", "210514_x_at", "211528_x_at", 
    "211529_x_at", "211530_x_at")))

gene_names <- structure(list(SYMBOL = structure(c(2L, 2L, 9L, 9L, 9L, 9L, 15L, 
15L, 18L, 18L, 19L, 18L, 21L, 21L, 16L, 17L, 5L, 5L, 5L, 5L, 
1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 20L, 
20L, 20L, 20L, 20L, 22L, 22L, 22L, 22L, 22L, 8L, 8L, 7L, 7L, 
6L, 6L, 6L, 6L, 6L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 10L, 10L, 
13L, 13L, 13L, 14L, 14L, 14L, 14L), .Label = c("APOE", "BDNF", 
"BIN1", "CLU", "COMT", "CR1", "GBA2", "GBA3", "HIP1", "HLA-A", 
"HLA-B", "HLA-C", "HLA-DRB4", "HLA-G", "HTT", "LRRK2", "NPTX2", 
"PARK2", "PARK7", "PICALM", "PINK1", "SNCA"), class = "factor")), .Names = "SYMBOL", row.names = c("206382_s_at", 
"239367_at", "1560317_s_at", "205425_at", "205426_s_at", "226364_at", 
"202389_s_at", "202390_s_at", "1554855_at", "1555668_a_at", "200006_at", 
"207058_s_at", "209018_s_at", "209019_s_at", "229584_at", "213479_at", 
"208817_at", "208818_s_at", "213981_at", "216204_at", "203381_s_at", 
"203382_s_at", "212874_at", "212883_at", "212884_x_at", "202931_x_at", 
"210201_x_at", "210202_s_at", "214439_x_at", "214643_x_at", "1559228_at", 
"208791_at", "208792_s_at", "222043_at", "203134_at", "212506_at", 
"212511_at", "215236_s_at", "215832_x_at", "204466_s_at", "204467_s_at", 
"207827_x_at", "211546_x_at", "236081_at", "219954_s_at", "222943_at", 
"223921_s_at", "224627_at", "206244_at", "208488_s_at", "217484_at", 
"217552_x_at", "244313_at", "208729_x_at", "209140_x_at", "211911_x_at", 
"208812_x_at", "211799_x_at", "214459_x_at", "216526_x_at", "213932_x_at", 
"215313_x_at", "209728_at", "215666_at", "215669_at", "210514_x_at", 
"211528_x_at", "211529_x_at", "211530_x_at"), class = "data.frame")
```

### Transforming the Data Set

The transformation we propose allows to transform a real data set ($X_0$) by hard coding the prior information we had on the groups. It allows to have a simulated dataset which we know is a part of a real minimisation problem with known parameters.

Choosing appropriate parameter values depends essentially on the application. One could want to radically change the original data set in order to clearly encode the penalty in the problem or one could want to generate a slightly different data set to evaluate the robustness of the tested analysis. 

In our application, we have three groups: HLA, COG and MOT. The first group is supposed to have no effect whatsoever on the difference between patients and controls. The two last ones supposedly have a strong effect for the MOT genes and a lesser effect for the COG genes. We see on the next Figure that these groups of genes are very difficultly differentiable on the real data set. After applying our scaling procedure, we see that the different groups of genes now cluster together. 

In the following, `norm2` corresponds to the $\ell_2$ norm function, $n$ is the number of individuals and $p$ the number of variables.
```{r aux_func}
norm2 <- function(u) sqrt(sum(u**2))
n <- nrow(X_0) ; p <- ncol(X_0)
```

The first step is to define the vector $\beta^*$ at which $f$ is minimum. In order to illustrate the interest of a Group LASSO penalty, we set $\beta^*_{HLA} = 0$ for the HLA control group of genes, and arbitrary non-null values for the other groups: $\beta^*_{COG} \sim N(-2,0.5)$ and $\beta^*_{MOT} \sim N(-1.5,0.3)$.
```{r betastar}
betastar <- sapply(as.character(class), switch, HLA=0, MOT=rnorm(1,-2,0.5), COG=rnorm(1,-1.5,0.3))
```
Following the algorithm described in the paper, we then set beforehand $\epsilon$, defined as the vector of residuals $X\beta^* -y$: 
```{r epsilon}
epsilon <- rnorm(n, 0, 0.1)
```
Once this is done, one crucial step is to compute the scaling value $\omega_j$ by which each column of $X_0$ is scaled to obtain a suitable data set $X$. $\omega_j$ is obtained, in our case by
\[ 
  \omega_j = - \frac{\partial_{\| \cdot \|_{GL}}(\beta^*)_j + \beta^*_j}{ < X_{0,j}, \epsilon >},
\]
with $\partial_{\| \cdot \|_{GL}}$ a function defined group by group (since there is no overlap between groups in our example). For each group, it is equal to the sub-gradient of the $\ell_2$-norm.
```{r sub_gradient}
rand <- function(size) { u <- rnorm(size, -5) ; u <- 0.9*u/norm2(u) ; return(u)}
omega <- rep(NA,p)
omega[class=="HLA"] <- - rand(sum(class=="HLA"))
omega[class=="MOT"] <- - betastar[class=="MOT"]/norm2(betastar[class=="MOT"])
omega[class=="COG"] <- - betastar[class=="COG"]/norm2(betastar[class=="COG"])
omega <- (omega - betastar) / drop( t(X_0)%*%epsilon )
```
Finally, the weights $\omega_j$ are applied to each column of $X_0$ to obtain $X$ and $y$ is computed by using $X$, $\beta^*$ and $\epsilon$. 
```{r compute_X_and_y}
X <- X_0 %*% diag(omega)
y <- X %*% betastar - epsilon
```

```{r colnames,echo=FALSE}
colnames(X) <- colnames(X_0)
```
The amplitude of the scaling can be modified by adjusting the noise parameter $\epsilon$. The within gene variability can also be tuned by playing with the values of $\beta^*_j$ and the random values taken by the subgradient. 

The following heatmaps (generated thanks to package `pheatmap` [2]) illustrate the effect of the scaling on the real data set:
```{r pretty_heatmap, echo=FALSE, message=FALSE, fig.align='center'}
require(pheatmap)
annot_genes <- data.frame(CLASS=class)
rownames(annot_genes) <- colnames(X)

pheatmap(X_0, annotation=data.frame(annot_genes, gene_names), main="Before transformation")
pheatmap(X, annotation=data.frame(annot_genes, gene_names), main="After transformation")
```

### Testing an Adapted Minimisation Algorithm on the Simulated Data Set

Once the data set $(X, y)$ is generated, we can apply any minimisation algorithm (aiming at minimising a Ridge Regression with a Group LASSO penalty) on this dataset, knowing that the solution should be as close as possible to the known $\beta^*$ and that the correct value for the penalisation parameter of the Group LASSO penalty is equal to 1.

In the following, we use FISTA [3] as a minimisation algorithm to make sure we achieved the correct minimum for the correct value (1) of the penalisation parameter. We therefore apply FISTA to a parameterised version of $f$, $f_\gamma$:
\[
  f_\gamma(\beta) = \frac{1}{2}\|X \beta - y\|_2^2 + \frac{1}{2}\|\beta\|_2^2 + \gamma \sum_{g \in G} \| \beta_g \|_2 .
\]
FISTA needs the following functions, respectively

* `grad` is the gradient of the smooth part of $f_\gamma$,
* and `prox` is the proximal operator associated with the Group LASSO penalty.

```{r functions}
grad <- function(X, y, beta) {
  return( crossprod(X, X %*% beta - y) + beta )
}

prox <- function(v, groups, ctt) {
  res <- rep(0, length(v))
  for (g in groups) {
    norm2_g <- norm2(v[g])
    if (norm2_g >= ctt) res[g] <- (1-ctt/norm2_g) * v[g]
  }
  return(res)
}
```
FISTA is then very synthetically defined as the following algorithm:
```{r fista}
fista <- function(X, y, beta0 =rep(0, ncol(X)), g = list(1:ncol(X)), gamma=1, const=NULL, precision=1e-1, kmax=5000){
  if (is.null(const)) const <- 1/(1 + eigen(X%*%t(X))$values[1])
  ynew <- betanew <- yold <- betaold <- beta0
  for (k in 1:kmax) {
    yold <- ynew
    ynew <- betanew + ((k-2)/(k+1))*(betanew-betaold)
    betaold <- betanew
    betanew <- prox( ynew-const*grad(X,y,ynew), g, const*gamma)
    if ( 1/const*sum(abs(betanew-ynew)) <= precision) break
    if (k==kmax) cat("k=kmax \n")
  }
  return(list(nbiter=k, beta=betanew))
}
```

Applying FISTA with different values of $\gamma$ results in solutions ($\beta^\infty$) that are not "optimal". More specifically, we see on the resulting curve below that the closest to $\beta^*$ is achieved when $\gamma$ is close to 1.

```{r gamma_curve, fig.width=10, fig.height=10, fig.align='center', cache=TRUE}
const <- 1/(1 + eigen(X%*%t(X))$values[1])

g <- split(1:ncol(X), class)

gammavec <- c(100,10,rev(seq(0.5, 1.5, length=50)))

prec <- 0.001
sse <- rep(NA,length(gammavec))
beta0 <- rnorm(p)

for (i in 1:length(gammavec)) {
  if (i!=1) beta0 <- res$beta
  res <- fista(X,y,beta0=beta0,g=g,gamma=gammavec[i],const=const,precision=prec,kmax=100000)
  sse[i] <- norm2(betastar-res$beta)
}

par(mar=c(5, 5, 4, 2) + 0.1)
plot(gammavec[-(1:2)], sse[-(1:2)], xlab=expression(gamma), type="l", lwd=2,
     ylab=expression(group("||",list(beta[gamma]^infinity - beta^symbol("*")),"||")[2]))
abline(v=1,col=2,lty=2,lwd=2)
grid()
legend("bottomright",expression(gamma==1),col=2,lty=2,bty="n",lwd=2)

```

### References

1. Lesnick T.G., Papapetropoulos S., Mash D.C., Ffrench-Mullen J., Shehadeh L., et al. (2007). A Genomic Pathway Approach to a Complex Disease: Axon Guidance and Parkinson Disease. PLoS Genet 3(6): e98.
2. Kolde R.n (2013). `pheatmap`: Pretty Heatmaps. R package version 0.7.7, http://CRAN.R-project.org/package=pheatmap
3. Beck A., & Teboulle M. (2009). A Fast Iterative Shrinkage-Thresholding Algorithm for Linear Inverse Problems. SIAM Journal on Imaging Sciences, 2(1), 183–202.

